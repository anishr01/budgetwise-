<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.chart.*?>

<AnchorPane xmlns="http://javafx.com/javafx/21"
            xmlns:fx="http://javafx.com/fxml"
            fx:id="rootPane"
            fx:controller="com.budgetwise.javafx.controller.DashboardController"
            stylesheets="@/css/app.css"
            styleClass="root">

    <!-- ================= SIDEBAR ================= -->
    <VBox prefWidth="220"
          spacing="20"
          AnchorPane.topAnchor="0"
          AnchorPane.bottomAnchor="0"
          AnchorPane.leftAnchor="0"
          styleClass="sidebar">

        <Label text="ðŸ’° BudgetWise"
               styleClass="sidebar-title"/>

        <VBox spacing="12">
            <Label text="ðŸ“Š Expense Tracking"
                   styleClass="sidebar-item"
                   onMouseClicked="#openExpenses"/>

            <Label text="ðŸ’° Budget"
                   styleClass="sidebar-item"
                   onMouseClicked="#openBudget"/>

            <Label text="ðŸŽ¯ Saving Goals"
                   styleClass="sidebar-item"
                   onMouseClicked="#openSavingGoals"/>

            <Label text="ðŸ“ˆ Reports"
                   styleClass="sidebar-item"
                   onMouseClicked="#openReports"/>

            <Label text="âš™ Settings"
                   styleClass="sidebar-item"
                   onMouseClicked="#openSettings"/>
        </VBox>
    </VBox>

    <!-- ================= MAIN CONTENT ================= -->
    <ScrollPane AnchorPane.leftAnchor="220"
                AnchorPane.rightAnchor="0"
                AnchorPane.topAnchor="0"
                AnchorPane.bottomAnchor="0"
                fitToWidth="true">

        <VBox spacing="30"
              alignment="TOP_CENTER"
              maxWidth="Infinity"
              styleClass="card">

            <!-- Top bar -->
            <HBox alignment="CENTER_RIGHT" maxWidth="Infinity">
                <Button text="ðŸŒ™ Dark Mode"
                        onAction="#toggleDarkMode"
                        styleClass="toggle-btn"/>
            </HBox>

            <!-- Welcome -->
            <Label fx:id="welcomeLabel"
                   styleClass="welcome-name"/>

            <Label text="Welcome to BudgetWise Dashboard"
                   styleClass="dashboard-title"/>

            <Label text="You have successfully logged in"
                   styleClass="dashboard-subtitle"/>

            <Button text="â» Logout"
                    onAction="#handleLogout"
                    prefWidth="160"
                    styleClass="logout-btn"/>

            <!-- ================= DOWNLOAD REPORT BUTTONS ================= -->
            <HBox spacing="20"
                  alignment="CENTER">

                <Button text="â¬‡ Download CSV"
                        onAction="#downloadCsv"
                        prefWidth="180"
                        styleClass="action-btn"/>

                <Button text="â¬‡ Download PDF"
                        onAction="#downloadPdf"
                        prefWidth="180"
                        styleClass="action-btn"/>

            </HBox>


            <!-- ================= PIE CHART ================= -->
            <VBox spacing="20"
                  alignment="CENTER"
                  styleClass="card"
                  minHeight="580"
                  prefHeight="580"
                  maxWidth="Infinity">

                <Label text="Category-wise Expense Distribution"
                       styleClass="section-title"/>

                <PieChart fx:id="expensePieChart"
                          prefWidth="520"
                          prefHeight="520"
                          minWidth="520"
                          minHeight="520"
                          legendSide="RIGHT"/>
            </VBox>

            <!-- ================= BAR CHART (FIXED SIZE) ================= -->
            <VBox spacing="12"
                  alignment="CENTER"
                  styleClass="card"
                  VBox.vgrow="ALWAYS"
                  minHeight="420">

                <Label text="Income vs Expense"
                       styleClass="section-title"/>

                <BarChart fx:id="incomeExpenseBarChart"
                          prefHeight="350"
                          minHeight="350"
                          animated="false"
                          categoryGap="60"
                          barGap="20">
                    <xAxis>
                        <CategoryAxis/>
                    </xAxis>
                    <yAxis>
                        <NumberAxis/>
                    </yAxis>
                </BarChart>
            </VBox>

            <!-- ================= LINE CHART (FIXED SIZE) ================= -->
            <VBox spacing="12"
                  alignment="CENTER"
                  styleClass="card"
                  VBox.vgrow="ALWAYS"
                  minHeight="420">

                <Label text="Monthly Spending Trend"
                       styleClass="section-title"/>

                <LineChart fx:id="monthlyTrendLineChart"
                           prefHeight="350"
                           minHeight="350"
                           maxWidth="Infinity"
                           animated="true"
                           createSymbols="true">

                    <xAxis>
                        <CategoryAxis/>
                    </xAxis>

                    <yAxis>
                        <NumberAxis/>
                    </yAxis>

                </LineChart>
            </VBox>


            <!-- ================= AI INSIGHTS ================= -->
            <VBox spacing="12"
                  alignment="CENTER"
                  styleClass="card"
                  minHeight="200">

                <Label text="ðŸ¤– AI Spending Insights"
                       styleClass="section-title"/>

                <TextArea fx:id="aiInsightArea"
                          prefWidth="750"
                          prefHeight="150"
                          editable="false"
                          wrapText="true"/>
            </VBox>

        </VBox>



    </ScrollPane>
</AnchorPane>
